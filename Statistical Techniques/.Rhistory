knitr::opts_chunk$set(echo = TRUE)
require(ggplot2)
require(GGally)
require(corrplot)
library(ggplot2)
library(GGally)
getwd()
Fuel_Consumption<-read.csv("FuelConsumption.csv")
Fuel_Consumption<-data.frame(Fuel_Consumption)
dim(Fuel_Consumption)
str(Fuel_Consumption)
head(Fuel_Consumption)
summary(Fuel_Consumption)
par(mfrow=c(1,1),bg="lightyellow")
pairs(Fuel_Consumption[,c(-3,-1)],panel = panel.smooth,gap=1/4)
par(mfrow=c(1,1),bg="lightyellow")
sum(is.na(Fuel_Consumption))
sum(is.null(Fuel_Consumption))
boxplot(Fuel_Consumption$FUELCONSUMPTION_COMB)
boxplot(Fuel_Consumption$FUELCONSUMPTION_CITY)
boxplot(Fuel_Consumption$FUELCONSUMPTION_HWY)
boxplot(Fuel_Consumption$CO2EMISSIONS)
boxplot(Fuel_Consumption$FUELCONSUMPTION_COMB_MPG)
par(mfrow=c(1,1),bg="lightyellow")
hist(Fuel_Consumption$FUELCONSUMPTION_COMB)
hist(Fuel_Consumption$FUELCONSUMPTION_CITY)
hist(Fuel_Consumption$FUELCONSUMPTION_HWY)
hist(Fuel_Consumption$CO2EMISSIONS)
hist(Fuel_Consumption$FUELCONSUMPTION_COMB_MPG)
Fuel_Consumption$CYLINDERS<-as.factor(Fuel_Consumption$CYLINDERS)
Fuel_Consumption$ENGINESIZE<-as.factor(Fuel_Consumption$ENGINESIZE)
Fuel_Consumption$MODELYEAR<-as.factor(Fuel_Consumption$MODELYEAR)
set.seed(1234)
ids = sample(nrow(Fuel_Consumption), nrow(Fuel_Consumption)*0.6)
train<-data.frame(Fuel_Consumption[ids,])
test<-data.frame(Fuel_Consumption[-ids,])
num_data<-Fuel_Consumption[,c(9:13)]
factorial_data<-Fuel_Consumption[,-c(9:13)]
library(corrplot)
Fuel_Consumption_cor<-cor(num_data)
Fuel_Consumption_cor
corrplot(Fuel_Consumption_cor,method = "pie",type="lower")
par(mfrow=c(1,1),bg="lightyellow")
library(ggplot2)
ggplot(Fuel_Consumption,aes(Fuel_Consumption$ENGINESIZE))+geom_bar(fill="steelblue")+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(Fuel_Consumption,aes(Fuel_Consumption$VEHICLECLASS))+geom_bar(fill="steelblue")+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(Fuel_Consumption,aes(Fuel_Consumption$TRANSMISSION))+geom_bar(fill="steelblue")+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(Fuel_Consumption,aes(Fuel_Consumption$FUELTYPE))+geom_bar(fill="steelblue")+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(Fuel_Consumption,aes(Fuel_Consumption$MAKE))+geom_bar(fill="steelblue")+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
library(ggplot2)
suv<-Fuel_Consumption[Fuel_Consumption$VEHICLECLASS=="SUV - SMALL"|Fuel_Consumption$VEHICLECLASS=="SUV - STANDARD",]
head(suv)
ggplot(suv,aes(x=suv$MAKE))+geom_bar(fill="steelblue")+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(suv,aes(x=suv$ENGINESIZE))+geom_bar(fill="steelblue")+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
suv.aov<-aov(FUELCONSUMPTION_COMB~MAKE,data=suv)
summary(suv.aov)
plot(suv.aov,cex=1)
plot(suv$FUELCONSUMPTION_COMB~suv$MAKE,data=suv,col=1:30)
suv.aov_highway<-aov(FUELCONSUMPTION_HWY~MAKE,data=suv)
summary(suv.aov_highway)
plot(suv.aov_highway,cex=1)
plot(suv$FUELCONSUMPTION_HWY~suv$MAKE,data=suv,col=1:30)
suv.aov_city<-aov(FUELCONSUMPTION_CITY~MAKE,data=suv)
summary(suv.aov_city)
plot(suv.aov_city,cex=1)
plot(suv$FUELCONSUMPTION_CITY~suv$MAKE,data=suv,col=1:30)
suv.aov_model<-aov(FUELCONSUMPTION_COMB~MODEL,data=suv)
summary(suv.aov_model)
plot(suv.aov,cex=1)
ggplot(suv,aes(x=suv$MODEL,y=suv$FUELCONSUMPTION_COMB))+geom_boxplot(fill="steelblue")+ theme(text = element_text(size=4) ,axis.text.x = element_text(angle = 90, hjust = 1))
suv.aov_mpg<-aov(FUELCONSUMPTION_COMB_MPG~MAKE,data=suv)
summary(suv.aov_mpg)
plot(suv.aov_mpg,cex=1)
plot(suv$FUELCONSUMPTION_COMB_MPG~suv$MAKE,data=suv,col=1:30)
bartlett.test(suv$FUELCONSUMPTION_COMB_MPG~suv$MAKE)
bartlett.test(suv$FUELCONSUMPTION_CITY~suv$MAKE)
bartlett.test(suv$FUELCONSUMPTION_HWY~suv$MAKE)
bartlett.test(suv$FUELCONSUMPTION_COMB~suv$MAKE)
wilcox.test(suv$FUELCONSUMPTION_CITY,suv$FUELCONSUMPTION_HWY,conf.int=0.99,mu=0)
wilcox.test(suv$FUELCONSUMPTION_CITY,suv$FUELCONSUMPTION_COMB,conf.int=0.99,mu=0)
wilcox.test(suv$FUELCONSUMPTION_HWY,suv$FUELCONSUMPTION_COMB,conf.int=0.99,mu=0)
suv_lm<-lm(CO2EMISSIONS~FUELCONSUMPTION_COMB_MPG+FUELCONSUMPTION_COMB+MODEL+MAKE+ENGINESIZE+CYLINDERS+ENGINESIZE+TRANSMISSION,data = suv)
summary(suv_lm)
suv_coef<-which(sort(suv_lm$coefficients>0.5,decreasing = T))
suv_coef
FC_lm<-lm(CO2EMISSIONS~FUELCONSUMPTION_COMB_MPG+FUELCONSUMPTION_COMB+MODEL+MAKE+ENGINESIZE+CYLINDERS+ENGINESIZE+TRANSMISSION,data = Fuel_Consumption)
FC_coef<-which(sort(FC_lm$coefficients<0.5,decreasing = F))
str(FC_coef)
head(FC_coef,20)
non_suvfactors<-setdiff(FC_coef,suv_coef)
length(non_suvfactors)
length(FC_coef)
length(suv_coef)
suv_coef<-which(sort(suv_lm$coefficients>0.5,decreasing = F))
suv_coef
suv_coef<-which(sort(suv_lm$coefficients<0.5,decreasing = F))
suv_coef
FC_lm<-lm(CO2EMISSIONS~FUELCONSUMPTION_COMB_MPG+FUELCONSUMPTION_COMB+MODEL+MAKE+ENGINESIZE+CYLINDERS+ENGINESIZE+TRANSMISSION,data = Fuel_Consumption)
FC_coef<-which(sort(FC_lm$coefficients<0.5,decreasing = F))
str(FC_coef)
head(FC_coef,20)
non_suvfactors<-setdiff(FC_coef,suv_coef)
length(non_suvfactors)
length(FC_coef)
length(suv_coef)
head(summary(suv_lm),20)
suv_lm<-lm(CO2EMISSIONS~FUELCONSUMPTION_COMB_MPG+FUELCONSUMPTION_COMB+MODEL+MAKE+ENGINESIZE+CYLINDERS+ENGINESIZE+TRANSMISSION,data = suv)
summary(suv_lm)
suv_coef<-which(sort(suv_lm$coefficients<0.5,decreasing = F))
suv_coef
